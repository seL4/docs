<!DOCTYPE html>
<!-- Page last generated 2025-12-26 03:41:45 +0000 -->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Microkit Tutorial - Virtual machines | seL4 docs</title>

    <link rel="canonical" href="https://docs.sel4.systems/projects/microkit/tutorial/part4.html">
    <link href="/assets/css/sel4.css?v=1766720505" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">

    <script defer src="/assets/js/menu.js"></script>
    <script defer src="/assets/js/sidebar.js"></script><script defer data-domain="docs.sel4.systems"
            src="https://analytics.sel4.systems/js/script.js"></script></head>
  <body class="flex flex-row h-screen std-bg text-dark">
    <div id="sidebar" class="hidden lg:flex flex-none w-(--sidebar-width) flex-row bg-f_neutral-50 dark:bg-gray-900">
      <div class="flex-1 overflow-y-auto min-h-full">
        <a href="/">
  <svg xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="84.224365mm" height="32.530689mm" viewBox="0 0 84.224367 32.530689" version="1.1" id="svg5" inkscape:version="1.3.2 (091e20e, 2023-11-25)" sodipodi:docname="sel4-docs.svg" inkscape:export-filename="C:\Users\Birgit Brecknell\Documents\seL4 Foundation\seL4 Summit 2022\sel4_summit_v02.png" inkscape:export-xdpi="96" inkscape:export-ydpi="96" class="px-4 w-50 h-20 mx-auto mt-4 mb-10">
  <sodipodi:namedview id="namedview7" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageshadow="2" inkscape:pageopacity="0.0" inkscape:pagecheckerboard="0" inkscape:document-units="mm" showgrid="false" inkscape:zoom="1.8116734" inkscape:cx="193.19155" inkscape:cy="87.764163" inkscape:window-width="1392" inkscape:window-height="1099" inkscape:window-x="0" inkscape:window-y="25" inkscape:window-maximized="0" inkscape:current-layer="g18" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" showguides="true" inkscape:guide-bbox="true" inkscape:showpageshadow="2" inkscape:deskcolor="#d1d1d1"/>
  <defs id="defs2">
    <rect x="680.69342" y="102.26014" width="15.612235" height="115.53054" id="rect9649"/>
    <style id="style824">.cls-1,.cls-2,.cls-3{fill:#96ca4f;}.cls-2,.cls-3{stroke:#96ca4f;stroke-miterlimit:8;}.cls-3{stroke-width:0.25px;}</style>
    <clipPath clipPathUnits="userSpaceOnUse" id="clipPath15">
      <g inkscape:label="Clip" id="use15">
        <path d="m 39.66384,47.73588 h 1.324364 q 0.447983,0 0.68299,0.06854 0.315791,0.09302 0.541007,0.330479 0.225215,0.237455 0.342719,0.582623 0.117503,0.342719 0.117503,0.847005 0,0.443087 -0.110159,0.763774 -0.13464,0.391679 -0.384335,0.63403 -0.188496,0.1836 -0.509183,0.286416 -0.239903,0.07589 -0.641374,0.07589 H 39.66384 Z m 0.724606,0.607103 v 2.377001 h 0.541006 q 0.303551,0 0.438191,-0.03427 0.176255,-0.04406 0.291311,-0.149327 0.117504,-0.105264 0.190944,-0.345168 0.07344,-0.242351 0.07344,-0.65851 0,-0.416159 -0.07344,-0.638926 -0.07344,-0.222767 -0.205632,-0.347615 -0.132192,-0.124848 -0.335375,-0.168912 -0.151776,-0.03427 -0.594862,-0.03427 z m 2.751544,1.209308 q 0,-0.54835 0.164016,-0.920445 0.122399,-0.274175 0.332927,-0.492047 0.212975,-0.217871 0.465118,-0.323135 0.335375,-0.141984 0.773566,-0.141984 0.79315,0 1.268061,0.492047 0.477358,0.492047 0.477358,1.368428 0,0.869038 -0.472462,1.361085 -0.472463,0.489598 -1.263165,0.489598 -0.800494,0 -1.272956,-0.48715 -0.472463,-0.489599 -0.472463,-1.346397 z m 0.746638,-0.02448 q 0,0.609551 0.281519,0.925342 0.281519,0.313343 0.714814,0.313343 0.433295,0 0.709918,-0.310895 0.279072,-0.313343 0.279072,-0.937582 0,-0.616894 -0.271728,-0.920445 -0.269279,-0.303551 -0.717262,-0.303551 -0.447983,0 -0.722158,0.308447 -0.274175,0.305999 -0.274175,0.925341 z m 5.596112,0.477359 0.702574,0.222767 q -0.161567,0.587519 -0.538558,0.873934 -0.374543,0.283967 -0.95227,0.283967 -0.714814,0 -1.175036,-0.48715 -0.460223,-0.489599 -0.460223,-1.336605 0,-0.895965 0.462671,-1.39046 0.46267,-0.496943 1.216652,-0.496943 0.658511,0 1.069773,0.389231 0.2448,0.230112 0.367199,0.660959 l -0.717262,0.171359 q -0.06365,-0.279071 -0.266831,-0.440639 -0.200735,-0.161567 -0.489599,-0.161567 -0.399022,0 -0.648718,0.286415 -0.247247,0.286415 -0.247247,0.927789 0,0.680542 0.244799,0.969406 0.2448,0.288863 0.636478,0.288863 0.288864,0 0.496943,-0.1836 0.20808,-0.183599 0.298655,-0.577726 z m 1.140766,0.151776 0.705022,-0.06854 q 0.06365,0.354959 0.257039,0.521422 0.19584,0.166464 0.526319,0.166464 0.350063,0 0.526318,-0.14688 0.178704,-0.149327 0.178704,-0.347615 0,-0.127295 -0.07589,-0.215423 -0.07344,-0.09058 -0.259487,-0.156672 -0.127296,-0.04406 -0.580175,-0.156671 -0.582622,-0.144432 -0.81763,-0.354959 -0.330479,-0.296208 -0.330479,-0.722158 0,-0.274176 0.154224,-0.511631 0.156671,-0.239903 0.447983,-0.364751 0.293759,-0.124848 0.70747,-0.124848 0.675646,0 1.015917,0.296208 0.342719,0.296207 0.359855,0.790701 l -0.724606,0.03182 q -0.04651,-0.276623 -0.200735,-0.396575 -0.151776,-0.122399 -0.457775,-0.122399 -0.315791,0 -0.494495,0.129743 -0.115056,0.08323 -0.115056,0.222768 0,0.127295 0.107712,0.217871 0.137088,0.115056 0.665854,0.239904 0.528767,0.124847 0.78091,0.259487 0.254591,0.132191 0.396575,0.364751 0.144432,0.230111 0.144432,0.570382 0,0.308447 -0.17136,0.577727 -0.171359,0.269279 -0.484703,0.401471 -0.313343,0.129743 -0.780909,0.129743 -0.680542,0 -1.045293,-0.313343 -0.364751,-0.315791 -0.435743,-0.917997 z" id="path16" style="font-weight:bold;font-stretch:condensed;font-size:5.01349px;font-family:Arial;-inkscape-font-specification:'Arial, Bold Condensed';fill:#96ca4f;stroke-width:0.264583" transform="scale(1.0680757,0.9362632)" aria-label="DOCS"/>
      </g>
    </clipPath>
  </defs>
  <g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-11.065137,-18.670029)">
    <g id="g18">
      <text xml:space="preserve" transform="scale(0.26458333)" id="text9647" style="font-style:normal;font-weight:normal;font-size:40px;line-height:1.25;font-family:sans-serif;white-space:pre;shape-inside:url(#rect9649);display:inline;fill:#000000;fill-opacity:1;stroke:none"/>
      <g id="Layer_2" data-name="Layer 2" transform="matrix(0.5563179,0,0,0.5563179,-0.00218815,0)">
        <path class="cls-1" d="M 169.29,64.52 V 41.46 h -11.1 l -19.38,23.1 h -5.43 v -28.5 h -10.85 v 28.5 h -5.6 c 0,-0.53 0.08,-1.14 0.08,-1.88 V 62 h -6.77 v 1.94 a 6.32,6.32 0 0 1 -0.37,2.63 1.68,1.68 0 0 1 -1.66,0.88 1.5,1.5 0 0 1 -1.42,-0.71 5,5 0 0 1 -0.32,-2.33 V 58.73 H 117 V 56 a 13,13 0 0 0 -0.85,-5.23 6.31,6.31 0 0 0 -2.92,-2.88 11.68,11.68 0 0 0 -5.43,-1.11 11.49,11.49 0 0 0 -4.76,0.93 5.75,5.75 0 0 0 -2.88,2.57 10.54,10.54 0 0 0 -0.89,4.76 v 7 a 20,20 0 0 0 0.13,2.5 h -3 c 0,-0.28 0,-0.56 0,-0.87 a 5.84,5.84 0 0 0 -1,-3.71 12.59,12.59 0 0 0 -4.47,-2.8 22,22 0 0 1 -3.6,-1.84 3,3 0 0 1 -1.22,-1.32 6,6 0 0 1 -0.19,-1.77 2.32,2.32 0 0 1 0.45,-1.52 1.7,1.7 0 0 1 1.39,-0.58 1.5,1.5 0 0 1 1.49,0.71 5.86,5.86 0 0 1 0.25,2.32 v 1.3 h 6.27 V 53 a 11.15,11.15 0 0 0 -0.2,-2.55 3.72,3.72 0 0 0 -1.08,-1.63 6.68,6.68 0 0 0 -2.67,-1.49 14.3,14.3 0 0 0 -4.38,-0.58 13.32,13.32 0 0 0 -4.54,0.71 5,5 0 0 0 -2.63,1.92 7.84,7.84 0 0 0 -0.78,4 6.85,6.85 0 0 0 0.73,3.28 c 0.47,0.89 1.88,1.93 4.17,3.09 3.84,1.92 4.6,2.43 4.85,2.66 a 3.55,3.55 0 0 1 0.59,2.49 3,3 0 0 1 -0.46,2 A 2,2 0 0 1 87.8,67.45 1.5,1.5 0 0 1 86.3,66.6 6.54,6.54 0 0 1 86,63.87 v -2 h -6.29 v 1.62 c 0,0.38 0,0.72 0,1.05 h -6 a 25.58,25.58 0 1 0 0,8.83 H 158 v 8.42 h 11.33 v -8.4 h 5 V 64.52 Z M 38.89,75.1 A 6.1,6.1 0 1 1 45,69 6.1,6.1 0 0 1 38.89,75.1 Z m 67.54,-20.86 a 7.57,7.57 0 0 1 0.24,-2.68 c 0.15,-0.34 0.53,-0.75 1.48,-0.75 a 1.36,1.36 0 0 1 1.35,0.84 7.39,7.39 0 0 1 0.25,2.59 v 2.23 h -3.32 z M 158,64.52 h -9.62 L 158,52.22 Z" transform="translate(-3.04,-2.5)" id="path858"/>
      </g>
      <text xml:space="preserve" style="font-weight:bold;font-stretch:condensed;font-size:8.61839px;font-family:Arial;-inkscape-font-specification:'Arial, Bold Condensed';fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.505292;stroke-opacity:1" x="48.089367" y="45.416836" id="text16" transform="scale(0.93916555,1.064775)"><tspan sodipodi:role="line" id="tspan16" style="fill:#96ca4f;fill-opacity:1;stroke:none;stroke-width:0.505292" x="48.089367" y="45.416836">D</tspan></text>
      <text xml:space="preserve" style="font-weight:bold;font-stretch:condensed;font-size:8.87389px;font-family:Arial;-inkscape-font-specification:'Arial, Bold Condensed';fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.505292;stroke-opacity:1" x="54.558205" y="48.250385" id="text16-9"><tspan sodipodi:role="line" id="tspan16-1" style="fill:#96ca4f;fill-opacity:1;stroke:none;stroke-width:0.505292" x="54.558205" y="48.250385">O</tspan></text>
      <g id="g1" transform="matrix(1.1426343,0,0,1.1426343,24.136464,-10.044912)" style="stroke-width:1.67137">
        <text xml:space="preserve" style="font-weight:bold;font-stretch:condensed;font-size:7.7611px;font-family:Arial;-inkscape-font-specification:'Arial, Bold Condensed';fill:none;fill-opacity:1;fill-rule:evenodd;stroke:#000000;stroke-width:0.442217;stroke-opacity:1" x="44.508698" y="51.014606" id="text16-5"><tspan sodipodi:role="line" id="tspan16-8" style="fill:#96ca4f;fill-opacity:1;stroke:none;stroke-width:0.442217" x="44.508698" y="51.014606">S</tspan></text>
      </g>
      <text xml:space="preserve" style="font-weight:bold;font-stretch:condensed;font-size:8.87389px;font-family:Arial;-inkscape-font-specification:'Arial, Bold Condensed';fill:#96ca4f;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.505292;stroke-opacity:1" x="65.022789" y="48.250385" id="text17"><tspan sodipodi:role="line" id="tspan17" style="stroke-width:0.505292" x="65.022789" y="48.250385">C</tspan></text>
    </g>
  </g>
</svg>
</a>

<ul class="px-4 my-10 ext-links">
  <li class="mt-1">
    <div class=" mb-1 menu-title hover:text-hi leading-none">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron p-0 h-4 w-4 mb-px -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
      <span class="cursor-pointer text-sm">Getting Started</span>
    </div>
    <ul class="menu-content ml-6 ">
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/getting-started.html">Overview</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/Tutorials/">Tutorials</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/dockerfiles/">Setting up with Docker</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/buildsystem/repo-cheatsheet.html">Repo manifest cheat sheet</a>
        </li>
    </ul>
  </li>
  <li class="mt-1">
    <div class=" mb-1 menu-title hover:text-hi leading-none">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron p-0 h-4 w-4 mb-px -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
      <span class="cursor-pointer text-sm">The seL4 Kernel</span>
    </div>
    <ul class="menu-content ml-6 ">
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/sel4/">Overview</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/buildsystem/host-dependencies.html">Setting up</a>
        </li>
      <li class="pl-3 pb-1 border-l-1 bordercol">
        <div class="text-sm  menu-title text-light hover:text-hi">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron h-4 w-4 mb-0.5 -ml-2 -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
          <span class="cursor-pointer">Tutorial</span>
        </div>
        <ul class="menu-content ml-3 ">
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/setting-up.html">Setting up</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/get-the-tutorials.html">Getting the tutorials</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/hello-world.html">Hello world</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/capabilities.html">Capabilities</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/untyped.html">Untyped</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/mapping.html">Mapping</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/threads.html">Threads</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/ipc.html">IPC</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/notifications.html">Notifications</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/interrupts.html">Interrupts</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/fault-handlers.html">Fault handling</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/mcs.html">MCS</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/seL4-end.html">End</a>
            </li>
        </ul>
      </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/Tutorials/how-to-seL4.html">How-to</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/sel4/api-doc.html">API docs</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/sel4/manual.html">Manual</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/Hardware/">Supported platforms</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/sel4/verified-configurations.html">Verified configurations</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/sel4/configurations.html">Configurations</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/buildsystem/standalone.html">Standalone seL4 builds</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/sel4/bfgen.html">Bitfield generator</a>
        </li>
      <li class="pl-3 pb-1 border-l-1 bordercol">
        <div class="text-sm  menu-title text-light hover:text-hi">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron h-4 w-4 mb-0.5 -ml-2 -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
          <span class="cursor-pointer">Testing &amp; benchmarking</span>
        </div>
        <ul class="menu-content ml-3 ">
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/sel4test/">seL4test</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/sel4-tutorials/debugging-guide.html">Debugging guide</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/sel4-tutorials/debugging-userspace.html">Debugging user space</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/sel4bench/">sel4bench</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/sel4-tutorials/benchmarking-guide.html">Benchmarking guide</a>
            </li>
        </ul>
      </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/sel4/kernel-contribution.html">Contributing</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/sel4/porting.html">Porting to a new platform</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/releases/seL4.html">Releases</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="https://github.com/seL4/seL4">Sources</a>
        </li>
    </ul>
  </li>
<li class="-mt-2">&nbsp;</li>
  <li class="mt-1">
    <div class="font-bold mb-1 menu-title hover:text-hi leading-none">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron p-0 h-4 w-4 mb-px -mr-0.5 inline cursor-pointer ">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
      <span class="cursor-pointer text-sm">Microkit</span>
    </div>
    <ul class="menu-content ml-6 on">
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/microkit/">Overview</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/microkit/setting-up.html">Setting up your machine</a>
        </li>
      <li class="pl-3 pb-1 border-l-1 bordercol">
        <div class="text-sm font-bold menu-title text-light hover:text-hi">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron h-4 w-4 mb-0.5 -ml-2 -mr-0.5 inline cursor-pointer ">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
          <span class="cursor-pointer">Tutorial</span>
        </div>
        <ul class="menu-content ml-3 on">
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/microkit/tutorial/welcome.html">Welcome</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/microkit/tutorial/part0.html">Part 0 - Setting up</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/microkit/tutorial/part1.html">Part 1 - Serial server</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/microkit/tutorial/part2.html">Part 2 - Client</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/microkit/tutorial/part3.html">Part 3 - Wordle server</a>
            </li>
            <li class="text-hi border-f_green-500 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/microkit/tutorial/part4.html">Part 4 - Virtual machines</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/microkit/tutorial/end.html">End</a>
            </li>
        </ul>
      </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/microkit/manual/latest/">Manual</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/microkit/roadmap.html">Roadmap</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/microkit/platforms.html">Supported platforms</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/releases/microkit.html">Releases</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="https://github.com/seL4/microkit">Sources</a>
        </li>
    </ul>
  </li>
  <li class="mt-1">
    <div class=" mb-1 menu-title hover:text-hi leading-none">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron p-0 h-4 w-4 mb-px -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
      <span class="cursor-pointer text-sm">CAmkES</span>
    </div>
    <ul class="menu-content ml-6 ">
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/camkes/">Overview</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/camkes/setting-up.html">Setting up your machine</a>
        </li>
      <li class="pl-3 pb-1 border-l-1 bordercol">
        <div class="text-sm  menu-title text-light hover:text-hi">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron h-4 w-4 mb-0.5 -ml-2 -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
          <span class="cursor-pointer">Tutorials</span>
        </div>
        <ul class="menu-content ml-3 ">
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/hello-camkes-0.html">Hello CAmkES</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/hello-camkes-1.html">Introduction</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/hello-camkes-2.html">Events</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/hello-camkes-timer.html">Timer</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/camkes-vm-linux.html">Virtual Machines</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/camkes-vm-crossvm.html">Cross-VM connectors</a>
            </li>
        </ul>
      </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/Tutorials/how-to-CAmkES.html">How-to</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/camkes/manual.html">Manual</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/camkes/hardware.html">Supported platforms</a>
        </li>
      <li class="pl-3 pb-1 border-l-1 bordercol">
        <div class="text-sm  menu-title text-light hover:text-hi">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron h-4 w-4 mb-0.5 -ml-2 -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
          <span class="cursor-pointer">Virtualisation</span>
        </div>
        <ul class="menu-content ml-3 ">
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/camkes-vm/">CAmkES VM</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/virtualization/docs/libsel4vm.html">VM library</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/projects/virtualization/docs/libsel4vmm.html">VMM library</a>
            </li>
        </ul>
      </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/releases/camkes.html">Releases</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="https://github.com/seL4/camkes-tool/">Sources</a>
        </li>
    </ul>
  </li>
<li class="-mt-2">&nbsp;</li>
  <li class="mt-1">
    <div class=" mb-1 menu-title hover:text-hi leading-none">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron p-0 h-4 w-4 mb-px -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
      <span class="cursor-pointer text-sm">C support</span>
    </div>
    <ul class="menu-content ml-6 ">
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/sel4runtime/">C runtime</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/user_libs/">User-level libraries</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/buildsystem/">Build System</a>
        </li>
      <li class="pl-3 pb-1 border-l-1 bordercol">
        <div class="text-sm  menu-title text-light hover:text-hi">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron h-4 w-4 mb-0.5 -ml-2 -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
          <span class="cursor-pointer">Tutorials</span>
        </div>
        <ul class="menu-content ml-3 ">
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/libraries-1.html">Init & Threads</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/libraries-2.html">IPC</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/libraries-3.html">ELF loading & Processes</a>
            </li>
            <li class="text-light bordercol pl-3 border-l-1 text-sm leading-5 hover:text-hi">
              <a href="/Tutorials/libraries-4.html">Timer</a>
            </li>
        </ul>
      </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/Tutorials/how-to-libs.html">How-to</a>
        </li>
    </ul>
  </li>
  <li class="mt-1">
    <div class=" mb-1 menu-title hover:text-hi leading-none">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron p-0 h-4 w-4 mb-px -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
      <span class="cursor-pointer text-sm">Rust support</span>
    </div>
    <ul class="menu-content ml-6 ">
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/rust/">Overview</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/rust/how-to-use.html">How to use</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/rust/tutorial/introduction.html">Tutorial</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="https://sel4.github.io/rust-sel4/">API</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/rust/supported-configurations.html">Supported configurations</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/rust/releases.html">Releases</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="https://github.com/seL4/rust-sel4">Sources</a>
        </li>
    </ul>
  </li>
<li class="-mt-2">&nbsp;</li>
  <li class="mt-1">
    <div class=" mb-1 menu-title hover:text-hi leading-none">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron p-0 h-4 w-4 mb-px -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
      <span class="cursor-pointer text-sm">ELF loader</span>
    </div>
    <ul class="menu-content ml-6 ">
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/elfloader/">ELF loader for C</a>
        </li>
    </ul>
  </li>
  <li class="mt-1">
    <div class=" mb-1 menu-title hover:text-hi leading-none">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron p-0 h-4 w-4 mb-px -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
      <span class="cursor-pointer text-sm">capDL</span>
    </div>
    <ul class="menu-content ml-6 ">
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/capdl/">Overview</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/capdl/lang-spec.html">Language Spec</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/projects/capdl/c-loader-app.html">capDL loader (C)</a>
        </li>
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/releases/capDL.html">Releases</a>
        </li>
    </ul>
  </li>
<li class="-mt-2">&nbsp;</li>
  <li class="mt-1">
    <div class=" mb-1 menu-title hover:text-hi leading-none">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon" class="menu-chevron p-0 h-4 w-4 mb-px -mr-0.5 inline cursor-pointer rotate-270">
  <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
</svg>
      <span class="cursor-pointer text-sm">Examples &amp; demos</span>
    </div>
    <ul class="menu-content ml-6 ">
        <li class="text-light bordercol pb-1 pl-3 border-l-1 text-sm leading-5 hover:text-hi">
          <a href="/examples.html">Overview</a>
        </li>
    </ul>
  </li>
</ul>

      </div>
      <div id="sidebar-handle"
           class="flex-none relative cursor-col-resize min-h-full
                  bg-gray-200 dark:bg-gray-700 w-px">
      </div>
    </div>
    <div class="flex-1">
      
<div class="w-full pb-px bg-gray-200 dark:bg-gray-700">
  <header class="h-[2rem] sm:h-[2.5rem] lg:h-[3.5rem] w-full flex flex-row items-center gap-2 md:gap-4 md:py-2 std-bg">
    <div id="burger">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="text-dark ml-3 mr-0 sm:mr-3 lg:mx-4 w-4 h-4 lg:w-6 lg:h-6 cursor-pointer">
  <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/>
</svg>
    </div>
    <div class="flex-1"></div>
    <a href="/releases.html"
      class="text-lighter hover:text-light hover:underline text-tiny sm:text-xs lg:text-sm font-semibold">
      Releases
    </a>
    <a href="https://sel4.systems/Contribute/"
      class="text-lighter hover:text-light hover:underline text-tiny sm:text-xs lg:text-sm font-semibold">
      Contribute
    </a>
    <a href="https://sel4.systems/contact.html"
      class="text-lighter hover:text-light hover:underline text-tiny sm:text-xs lg:text-sm font-semibold">
      Contact
    </a>
    <a href="https://sel4.systems/support.html"
      class="text-lighter hover:text-light hover:underline text-tiny sm:text-xs lg:text-sm font-semibold">
      Support
    </a>
    <!-- main site button -->
    <a href="https://sel4.systems"
      class="flex-none button-outline ml-0 text-tiny px-2 py-0.5 sm:px-3 sm:py-1 h-4 sm:h-6 md:py-2 md:h-8 lg:h-9 md:text-xs lg:text-sm mr-0 md:mr-4">Main Site
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" viewBox="0 0 24 24" stroke="currentColor" data-slot="icon" class="hidden sm:inline-icon">
<path stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"/>
</svg>
    </a>
    <!-- github button -->
    <a href="https://github.com/seL4"
      class="mr-2 lg:mr-6 px-0 sm:px-3 pt-2 sm:pt-1 pb-2 block text-gray-400 dark:text-gray-500 hover:text-gray-500 dark:hover:text-gray-300">
      <span class="sr-only">seL4 on GitHub</span>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true" data-slot="icon" class="w-4 h-4 sm:w-5 sm:h-5 lg:w-6 lg:h-6">
<path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
</svg>
    </a>
  </header>
</div>

      <div class="grid grid-cols-1 xl:grid-cols-[4rem_auto_4rem] h-[calc(100%-3rem)]">
        <div class="hidden xl:flex relative hover:bg-gray-100 dark:hover:bg-gray-800 items-center justify-center">
          <a href="part3.html" class="mx-auto my-auto text-lighter">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-7 w-7 stroke-3">
  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"/>
</svg>
            <span class="absolute inset-0"></span>
          </a>
          </div>
        <div class="flex flex-col max-w-full overflow-y-auto">
          <div id="main-div" class="flex-1 max-w-full">
            <main class="mx-6 md:mx-10 xl:mx-12 my-12
                        overflow-x-auto" id="page-top">

              <div class="theprose mx-auto  ext-links">
  
<h1 id="part-4---virtual-machines">Part 4 - Virtual machines</h1>

<p>Now that you have a playable Wordle, you will notice that the word to guess
is always “hello” and does not change. That is a bit boring and not realistic.</p>

<p>The real Wordle game client works by having some server contain the word that
changes every day. What if we could do something similar so that every time we
start the game, we have to guess a new word? One way of doing this would be
talking to some external server that picks a random word which the Wordle server
receives.</p>

<p>This approach sounds complicated, and from part 1 you will know that in this tutorial we had to implement our own device driver just to be able to output characters to a screen. Talking
to the internet would require an ethernet device driver which is non-trivial to create.</p>

<p>What if we wanted to have other more complicated systems? We would have to implement a lot
of device drivers. For hardware like USB or Bluetooth, there would be
hundreds of thousands of lines of code we would have to port from Linux or something
else to get working on seL4.</p>

<p><strong>However</strong>, there is a quicker and easier approach. We can run a virtual machine! <sup id="fnref:vms"><a href="#fn:vms" class="footnote" rel="footnote" role="doc-noteref">1</a></sup></p>

<p>In this part, you will be shown how to run a virtual machine running Linux using
Microkit. We will make use of the ethernet driver that already exists in Linux to
talk to a server <code class="language-plaintext highlighter-rouge">trustworthy.systems/projects/microkit/tutorial/word</code> that responds with a new five-letter word
on every request.</p>

<p>If you do <code class="language-plaintext highlighter-rouge">wget -qO- trustworthy.systems/projects/microkit/tutorial/word</code>, you should see a new word each time
you run the command.</p>

<h2 id="virtual-machines-on-sel4">Virtual machines on seL4</h2>

<p><img style="display: block; margin: auto;" width="400" src="assets/part4/passthrough.svg" alt="Virtual machine with passthrough ethernet diagram" /></p>

<p>This diagram shows two main components involved when using virtual machines on top of seL4. Obviously there is a
virtual machine (VM), but there is also a virtual machine monitor (VMM). The VMM is responsible for starting and
managing the VM for its lifetime. As the VM doesn’t necessarily know it is being virtualised and thinks that it
is just running directly on hardware, it will try to perform operations such as memory read/write to regions of
memory we do not want it to. Making these kinds of restrictions is well-suited to a capability system, as we can easily control exactly
what resources the VM has power over.</p>

<p>In this case we <em>want</em> to give the VM access to the ethernet device, so we map the address of the device into
the VM’s virtual machine. This is typically called “pass-through” because, as you can see from the diagram, the
VM bypasses both the VMM and seL4 when it accesses the device. This is ideal for performance as it means that
the VMM nor seL4 consume any CPU when the VM is accessing the device.</p>

<p>However, interrupts are still managed through seL4 and the VMM. The reason for this is because we do not want
the virtual machine to be able to mess with any other interrupts in the system, and most hardware architectures
(such as ARM which we are using today) leave this problem up to software.</p>

<h2 id="integrating-with-the-wordle-system">Integrating with the Wordle system</h2>

<p>Our goal is to have a Linux virtual machine start that then gets the word from <code class="language-plaintext highlighter-rouge">trustworthy.systems/projects/microkit/tutorial/word</code> which
it sends to the VMM for it to give to the Wordle server.</p>

<p>In Microkit it is possible to describe a VM using the <code class="language-plaintext highlighter-rouge">virtual_machine</code> element. It is
very similar to a PD in that it has its own TCB, VSpace and CSpace.</p>

<p>There are a few pieces in order to create a VMM and VM in the system description, so I have given the description
for you to copy-and-paste into your <code class="language-plaintext highlighter-rouge">wordle.system</code>. There are comments to help you understand all the pieces.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--
    This is what the virtual machine will use as its "RAM".
    Remember it does not know it is a VM and so it will expect a
    block of contigious memory as RAM.
--&gt;</span>
<span class="nt">&lt;memory_region</span> <span class="na">name=</span><span class="s">"guest_ram"</span> <span class="na">size=</span><span class="s">"0x10000000"</span> <span class="na">page_size=</span><span class="s">"0x200_000"</span>
    <span class="na">phys_addr=</span><span class="s">"0x40000000"</span> <span class="nt">/&gt;</span>
<span class="c">&lt;!-- Create a memory region for the ethernet device --&gt;</span>
<span class="nt">&lt;memory_region</span> <span class="na">name=</span><span class="s">"ethernet"</span> <span class="na">size=</span><span class="s">"0x1000"</span> <span class="na">phys_addr=</span><span class="s">"0xa003000"</span> <span class="nt">/&gt;</span>
<span class="c">&lt;!--
    Create a memory region for the GIC CPU interface. This is a device
    that is virtualised at the hardware-level, unlike other parts
    of the GIC.
--&gt;</span>
<span class="nt">&lt;memory_region</span> <span class="na">name=</span><span class="s">"gic_vcpu"</span> <span class="na">size=</span><span class="s">"0x1000"</span> <span class="na">phys_addr=</span><span class="s">"0x8040000"</span> <span class="nt">/&gt;</span>

<span class="c">&lt;!-- Create a VMM protection domain --&gt;</span>
<span class="nt">&lt;protection_domain</span> <span class="na">name=</span><span class="s">"vmm"</span> <span class="na">priority=</span><span class="s">"101"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;program_image</span> <span class="na">path=</span><span class="s">"vmm.elf"</span> <span class="nt">/&gt;</span>
    <span class="c">&lt;!--
        Map in the virtual machine's RAM region as the VMM needs
        access to it as well for starting and setting up the VM.
    --&gt;</span>
    <span class="nt">&lt;map</span> <span class="na">mr=</span><span class="s">"guest_ram"</span> <span class="na">vaddr=</span><span class="s">"0x40000000"</span> <span class="na">perms=</span><span class="s">"rw"</span>
        <span class="na">setvar_vaddr=</span><span class="s">"guest_ram_vaddr"</span> <span class="nt">/&gt;</span>
    <span class="c">&lt;!--
        Create the virtual machine, the vCPU `id` is used for the
        VMM to refer to the VM. Similar to channels and IRQs.
    --&gt;</span>
    <span class="nt">&lt;virtual_machine</span> <span class="na">name=</span><span class="s">"linux"</span> <span class="na">priority=</span><span class="s">"100"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;vcpu</span> <span class="na">id=</span><span class="s">"0"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">mr=</span><span class="s">"guest_ram"</span> <span class="na">vaddr=</span><span class="s">"0x40000000"</span> <span class="na">perms=</span><span class="s">"rwx"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">mr=</span><span class="s">"ethernet"</span> <span class="na">vaddr=</span><span class="s">"0xa003000"</span> <span class="na">perms=</span><span class="s">"rw"</span> <span class="na">cached=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">mr=</span><span class="s">"uart"</span> <span class="na">vaddr=</span><span class="s">"0x9000000"</span> <span class="na">perms=</span><span class="s">"rw"</span> <span class="na">cached=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;map</span> <span class="na">mr=</span><span class="s">"gic_vcpu"</span> <span class="na">vaddr=</span><span class="s">"0x8010000"</span> <span class="na">perms=</span><span class="s">"rw"</span> <span class="na">cached=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/virtual_machine&gt;</span>
    <span class="c">&lt;!--
        We want the VMM to receive the ethernet interrupts, which it
        will then deliver to the VM.
     --&gt;</span>
    <span class="nt">&lt;irq</span> <span class="na">irq=</span><span class="s">"79"</span> <span class="na">id=</span><span class="s">"2"</span> <span class="na">trigger=</span><span class="s">"edge"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/protection_domain&gt;</span>
</code></pre></div></div>

<p>Next, let’s try build and run the system to see Linux booting.</p>

<h3 id="building">Building</h3>

<p>For building part 4, run the command:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make part4
</code></pre></div></div>

<h3 id="running">Running</h3>

<p>The same command from the previous parts works:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make run
</code></pre></div></div>

<p>When you run the system, you will see a lot more output than the previous parts, most
of this is Linux’s boot logs. At the bottom you should see the following (note that it may take a couple of seconds):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Starting network: OK
udhcpc: started, v1.35.0
udhcpc: broadcasting discover
udhcpc: broadcasting select for 10.0.2.15, server 10.0.2.2
udhcpc: lease of 10.0.2.15 obtained from 10.0.2.2, lease time 86400
deleting routers
adding dns 10.0.2.3
Linux user-space: Send request to trustworthy.systems/projects/microkit/tutorial/word
Linux user-space: Received word
Linux user-space: Transfer word to virtual-machine monitor
vmm microkit_ppcall: invalid channel given '1'
</code></pre></div></div>

<p>What is happening here? Well after Linux boots it starts the initial task I have added a script that will
automatically run and get the current Wordle word and copy it to the VMM. Surprisingly, it is a very simple
script:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>

<span class="c"># Establish internet connection</span>
ifconfig eth0 up
udhcpc eth0

<span class="c"># Request the word</span>
<span class="nb">echo</span> <span class="s2">"Linux user-space: Send request to trustworthy.systems/projects/microkit/tutorial/word"</span>
<span class="nv">WORD</span><span class="o">=</span><span class="si">$(</span>wget <span class="nt">-qO-</span> <span class="nt">--no-check-certificate</span> trustworthy.systems/projects/microkit/tutorial/word<span class="si">)</span>
<span class="nb">echo</span> <span class="s2">"Linux user-space: Received word"</span>

<span class="c"># Need to go through each letter of the word</span>
<span class="c"># and then write it to a location that the</span>
<span class="c"># virtual machine monitor is expecting</span>
<span class="nb">echo</span> <span class="s2">"Linux user-space: Transfer word to virtual-machine monitor"</span>
busybox devmem 0x50000000 w <span class="si">$(</span><span class="nb">printf</span> <span class="s2">"%d"</span> <span class="s2">"'</span><span class="k">${</span><span class="nv">WORD</span>:0:1<span class="k">}</span><span class="s2">"</span><span class="si">)</span>
busybox devmem 0x50000001 w <span class="si">$(</span><span class="nb">printf</span> <span class="s2">"%d"</span> <span class="s2">"'</span><span class="k">${</span><span class="nv">WORD</span>:1:2<span class="k">}</span><span class="s2">"</span><span class="si">)</span>
busybox devmem 0x50000002 w <span class="si">$(</span><span class="nb">printf</span> <span class="s2">"%d"</span> <span class="s2">"'</span><span class="k">${</span><span class="nv">WORD</span>:2:3<span class="k">}</span><span class="s2">"</span><span class="si">)</span>
busybox devmem 0x50000003 w <span class="si">$(</span><span class="nb">printf</span> <span class="s2">"%d"</span> <span class="s2">"'</span><span class="k">${</span><span class="nv">WORD</span>:3:4<span class="k">}</span><span class="s2">"</span><span class="si">)</span>
busybox devmem 0x50000004 w <span class="si">$(</span><span class="nb">printf</span> <span class="s2">"%d"</span> <span class="s2">"'</span><span class="k">${</span><span class="nv">WORD</span>:4:5<span class="k">}</span><span class="s2">"</span><span class="si">)</span>
<span class="nb">echo</span> <span class="s2">"Linux user-space: Finished"</span>
</code></pre></div></div>

<p>Once we have the word, we simply transfer it character-by-character to the VMM using a tool that lets us write
to a physical address (physical address from the virtual machine’s point of view). Since the characters are being written to
memory that the VM does not have access to, this will cause a virtual memory fault which seL4 gives to the VMM to handle.
You will notice that this is not particularly efficient, especially if we were doing this process with large amounts of data.
Fortunately, other methods such as the virtIO standard exist. But for this tutorial, that is out of scope.</p>

<p>If we look at the last line of the output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vmm microkit_ppcall: invalid channel given '1'
</code></pre></div></div>

<p>What is happening is that the VMM is trying to perform a PPC to send the word to the Wordle server. However, as we do not have a
channel, we are trying to invoke a channel that does not exist!</p>

<p>We can easily fix this by creating a channel between the VMM and the Wordle server:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;channel&gt;</span>
    <span class="c">&lt;!-- The VMM code expects the channel ID to be 1. --&gt;</span>
    <span class="nt">&lt;end</span> <span class="na">pd=</span><span class="s">"vmm"</span> <span class="na">id=</span><span class="s">"1"</span> <span class="na">pp=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;end</span> <span class="na">pd=</span><span class="s">"wordle_server"</span> <span class="na">id=</span><span class="s">"2"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/channel&gt;</span>
</code></pre></div></div>

<p>Finally, we need to add code in <code class="language-plaintext highlighter-rouge">wordle_server.c</code> in order to handle the PPC from the VMM. We can look at how the
VMM is transferring the word here:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">microkit_msginfo</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">microkit_msginfo_new</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">WORDLE_WORD_SIZE</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">WORDLE_WORD_SIZE</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">microkit_mr_set</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">word</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="p">}</span>
<span class="n">microkit_ppcall</span><span class="p">(</span><span class="n">WORDLE_SERVER_CHANNEL</span><span class="p">,</span> <span class="n">msg</span><span class="p">);</span>
</code></pre></div></div>

<p>It is simply setting each character in one of the message-registers. So in the Wordle server you can read each
message-register using <code class="language-plaintext highlighter-rouge">uint64_t microkit_mr_get(uint8_t mr)</code> to update the <code class="language-plaintext highlighter-rouge">word</code> array from being equal to “hello”
to our new word.</p>

<p>After doing that and re-running the system, you should see the message <code class="language-plaintext highlighter-rouge">Linux user-space: Transfer word to virtual-machine monitor</code>.
Hit the <code class="language-plaintext highlighter-rouge">RETURN</code> key then you should see the client interface printing again. You can now guess the
secret word! If you do not want to guess, you can instead print out the word in the Wordle server :).</p>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:vms">
      <p>It is not always ideal to use virtual machines. Especially when you care about
    performance and reliability, having a native seL4 driver is typically better. <a href="#fnref:vms" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

</div>

            </main>
          </div>
          <nav class="flex xl:hidden flex-row justify-between items-center mb-12 text-lighter">
            <a href="part3.html" class="flex-none bg-gray-100 dark:bg-gray-800 rounded py-3 px-5 ml-12">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-5 w-5 stroke-2 md:h-7 md:w-7 md:stroke-3">
  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"/>
</svg>
            </a>
            <div class="flex-1"></div>
            <a href="end.html" class="flex-none bg-gray-100 dark:bg-gray-800 rounded py-3 px-5 mr-12">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-5 w-5 stroke-2 md:h-7 md:w-7 md:stroke-3">
  <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"/>
</svg>
            </a>
            </nav>
<footer class="flex-none flex flex-row py-6 pl-8 pr-10 border-t-1 bordercol
               text-xs lg:text-sm font-semibold text-lighter">
  <a href="/sitemap.html"
     class="flex-none hover:text-light hover:underline">Sitemap</a>
  <a href="/processes/test-status.html"
     class="mx-1 px-1 lg:mx-2 lg:px-2 bordercol border-l-2 flex-none hover:text-light hover:underline">Test status</a>
  <div class="flex-1"></div>
<a href="https://github.com/seL4/docs/edit/master/projects/microkit/tutorial/part4.md" class="flex-none  hover:text-light hover:underline">Edit
    page on GitHub</a>
</footer>

        </div>
        <div class="hidden xl:flex relative hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center justify-center">
          <a href="end.html" class="mx-auto my-auto text-lighter">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-7 w-7 stroke-3">
  <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"/>
</svg>
            <span class="absolute inset-0"></span>
          </a>
          </div>
        </div>
    </div>
  </body>
</html>
